<h1><%= @restaurant.name %> Dashboard</h1>

<section>
  <h2>Active Orders</h2>
  <% @active_orders.each do |order| %>
    <div>
      <p>Order #<%= order.id %></p>
      <p>Status: <%= order.status.capitalize %></p>
      <p>Total: <%= number_to_currency(order.total_price) %></p>
    </div>
  <% end %>
</section>

<section>
  <h2>Analytics</h2>
  <div>
    <h3>Orders</h3>
    <p>Daily Orders: <%= @daily_orders %></p>
    <h4>Order Status Distribution</h4>
    <% @order_status_distribution.each do |status, count| %>
      <p><%= status.capitalize %>: <%= count %></p>
    <% end %>
  </div>

  <div>
    <h3>Revenue</h3>
    <p>Total Revenue: <%= number_to_currency(@total_revenue) %></p>
    <p>Average Order Value: <%= number_to_currency(@average_order_value) %></p>
    <h4>Revenue by Day (Last 7 Days)</h4>
    <% @revenue_by_day.to_a.last(7).each do |date, revenue| %>
      <p><%= date.strftime("%B %d, %Y") %>: <%= number_to_currency(revenue) %></p>
    <% end %>
  </div>

  <div>
    <h3>Customer Analytics</h3>
    <p>Total Unique Customers: <%= @total_customers %></p>
    <p>Returning Customers: <%= @returning_customers %></p>
  </div>

  <div>
    <h3>Peak Hours</h3>
    <% @peak_hours.sort_by { |hour, _| hour }.each do |hour, count| %>
      <p><%= hour.to_s.rjust(2, '0') %>:00 - <%= count %> orders</p>
    <% end %>
  </div>
</section>

<section>
  <h2>Menu</h2>
  <div>
    <h3>Menu Item Availability</h3>
    <p>Available: <%= @menu_item_availability['available'] || 0 %></p>
    <p>Out of Stock: <%= @menu_item_availability['out_of_stock'] || 0 %></p>
  </div>

  <h3>All Menu Items</h3>
  <% @menu_items.each do |menu_item| %>
    <div>
      <h4><%= menu_item.name %></h4>
      <p>Price: <%= number_to_currency(menu_item.price) %></p>
      <p>Availability: <%= menu_item.availability.capitalize %></p>
      <%= link_to "Edit", edit_dashboard_menu_item_path(@restaurant, menu_item) %>
      <%= link_to "Delete", dashboard_menu_item_path(@restaurant, menu_item), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>
    </div>
  <% end %>
  <%= link_to "Add New Menu Item", new_dashboard_menu_item_path(@restaurant, @menu_item) %>
</section>

<section>
  <h2>Popular Items</h2>
  <div>
    <h3>Top 5 Most Ordered Items</h3>
    <ol>
      <% @top_items.each do |item| %>
        <li><%= item.name %></li>
      <% end %>
    </ol>
  </div>
  <div>
    <h3>Top 5 Highest Revenue Items</h3>
    <ol>
      <% @highest_revenue_items.each do |item| %>
        <li><%= item.name %></li>
      <% end %>
    </ol>
  </div>
</section>

<%= link_to "Edit Restaurant", edit_restaurant_path(@restaurant) %>
<%= link_to "Delete Restaurant", restaurant_path(@restaurant), data: { turbo_method: :delete, turbo_confirm: "Are you sure?" } %>